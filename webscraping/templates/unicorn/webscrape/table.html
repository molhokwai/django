
<!-- books/table.html -->
{% load unicorn %}
{% load define_action %}

<div unicorn:view>

    <table id="webscrapes-table"
           class="table table-auto rounded border-green-300 bg-slate-100">
        <thead class="p-4 text-gray">
            <tr>
                <!--
                    <td class="min-w-32">
                        &nbsp;
                    </td>
                -->

                {% for field in table_fields %}
                    <td class="bg-green-600 first:rounded-l-lg last:rounded-r-lg p-2
                               text-green-100 tracking-widest border-green-100">

                        {% define False as sort_field %}
                        {% if field in sort_fields %}
                            {% define True as sort_field %}
                        {% endif %}

                        <span>
                            {{ field|title }}{% if sort_field %}<strong 
                                    class="sort-arrows sort-field" 
                                    data-field="{{field}}">↓↑</strong>{% endif %}
                        </span>
                    </td>
                {% endfor %}
                    <td class="bg-green-600 first:rounded-l-lg last:rounded-r-lg p-2
                               text-green-100 tracking-widest border-green-100">
                    </td>
            </tr>
        </thead>
        <tbody id="webscrape-body">
            {% for webscrape in webscrapes %}
                {% unicorn 'webscrape.row' webscrape=webscrape key=webscrape.id parent=self %}
            {% endfor %}
        </tbody>
    </table>
    <script>
        function onSortFieldClick(e){
            console.log(`onSortFieldClick: ${e.target.dataset.field}`);
            const field = e.target.dataset.field;
            Unicorn.call("webscrape.table", "sort", field);
        }
        document.addEventListener('DOMContentLoaded', (e) => {
            document.querySelectorAll(".sort-field").forEach((field) => {
                field.addEventListener('click', onSortFieldClick);
            })
        });
    </script>

</div>
